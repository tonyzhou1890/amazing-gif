!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).AMZGif=e()}(this,function(){"use strict";function o(t,s,o,l){return new(o=o||Promise)(function(i,e){function a(t){try{n(l.next(t))}catch(t){e(t)}}function r(t){try{n(l.throw(t))}catch(t){e(t)}}function n(t){var e;t.done?i(t.value):((e=t.value)instanceof o?e:new o(function(t){t(e)})).then(a,r)}n((l=l.apply(t,s||[])).next())})}function c(t){return"function"==typeof t}const g={notReady:"数据未就绪",wrongParam:"参数错误",noGifUrl:"未指定 gif 图片地址",gifEmpty:"gif 不存在",gifDataTypeError:"gif 数据类型错误",notGif:"文件非 gif",noConfigEl:"未指定 img 元素",noImg:"未找到 img 元素",notImg:t=>`元素 ${t} 不是图片`,isRendering:"isRendering",skinError:"皮肤出错",skinContainerIsSmall:"空间不足以显示皮肤",errData:"数据格式错误"};function f(t){let e=1;for(;t>2**e;)e++;return e}function u(t,e,i,a){return((1<<i)-1&a)<<e|t}const e={loop:!0,auto:!1,interactive:!0,skin:"basic",speed:1},i=[.5,1,1.5,2],p=[0,0,0,255];var r=null;try{r=("undefined"!=typeof module&&"function"==typeof module.require&&module.require("worker_threads")||"function"==typeof __non_webpack_require__&&__non_webpack_require__("worker_threads")||"function"==typeof require&&require("worker_threads")).Worker}catch(t){}function t(t,e,i){var e=void 0===e?null:e,t=(i=void 0!==i&&i,Buffer.from(t,"base64").toString(i?"utf16":"utf8")),i=t.indexOf("\n",10)+1,a=t.substring(i)+(e?"//# sourceMappingURL="+e:"");return function(t){return new r(a,Object.assign({},t,{eval:!0}))}}function a(t,e,i){e=void 0===e?null:e,t=function(t,e){var i=atob(t);if(e){for(var a=new Uint8Array(i.length),r=0,n=i.length;r<n;++r)a[r]=i.charCodeAt(r);return String.fromCharCode.apply(null,new Uint16Array(a.buffer))}return i}(t,void 0!==i&&i),i=t.indexOf("\n",10)+1,t=t.substring(i)+(e?"//# sourceMappingURL="+e:""),i=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(i)}var n="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0);s=null,l=!(z="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwohZnVuY3Rpb24oKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gQyhlLHQsbyl7cmV0dXJuIGU+PnQmKDE8PG8pLTF9ZnVuY3Rpb24gbShlLHQsbyxsKXtyZXR1cm4oKDE8PG8pLTEmbCk8PHR8ZX12YXIgZT17ZGVjb2RlOihlLHQpPT57ZnVuY3Rpb24gbygpe3JldHVybiBuZXcgQXJyYXkoMioqZSsyKS5maWxsKDApLm1hcCgoZSx0KT0+U3RyaW5nLmZyb21DaGFyQ29kZSh0KSl9bGV0IGw9bygpO3ZhciBuPTIqKmUscj0yKiplKzE7bGV0IGE9ZSsxLHM9IiIsaT0hMDt2YXIgZD10Lmxlbmd0aDtsZXQgdT0wLGg9MCxjPWEsZj0wLGc9IiIsdj0wO2Zvcig7dTxkOyl7Zm9yKGM9YSxmPTA7MCE9PWMmJig4LWg+PWM/KGYrPUModFt1XSxoLGMpPDxhLWMsaCs9YyxjPTApOihmKz1DKHRbdV0saCw4LWgpPDxhLWMsYy09OC1oLGg9OCksISg4PT09aCYmKHUrKyxoPTAsdT49ZCkpKTspO2lmKGY9PT1yKWJyZWFrO2Y9PT1uPyhsPW8oKSxhPWUrMSxpPSEwKToodm9pZCAwIT09bFtmXT9pPyhzKz1sW2ZdLHY9ZixpPSExKToocys9bFtmXSxnPWxbZl1bMF0sbC5wdXNoKGxbdl0rZyksdj1mKToodm9pZCAwPT09bFt2XSYmY29uc29sZS5sb2codixzLmxlbmd0aCksZz1sW3ZdWzBdLHMrPWxbdl0rZyxsLnB1c2gobFt2XStnKSx2PWYpLGwubGVuZ3RoPj0yKiphJiZhPDEyJiZhKyspfWxldCBtPW5ldyBVaW50OEFycmF5KHMubGVuZ3RoKTtmb3IobGV0IGU9MDtlPHMubGVuZ3RoO2UrKyltW2VdPXMuY2hhckNvZGVBdChlKTtyZXR1cm4gbX0sZW5jb2RlOihsLG8pPT57ZnVuY3Rpb24gbigpe2NvbnN0IG89bmV3IE1hcDtyZXR1cm4gbmV3IEFycmF5KDIqKmwpLmZpbGwoMCkubWFwKChlLHQpPT57by5zZXQoU3RyaW5nLmZyb21DaGFyQ29kZSh0KSx0KX0pLG99ZnVuY3Rpb24gcihlKXtsZXQgdD1kO2lmKGMrMj49aC5sZW5ndGgpe2NvbnN0IG89bmV3IFVpbnQ4QXJyYXkoaC5sZW5ndGgrMjU2KTtvLnNldChoKSxoPW99Zm9yKDt0Oyk4LWY+PXQ/KGhbY109bShoW2NdLGYsdCxlKSxmKz10LHQ9MCk6KGhbY109bShoW2NdLGYsOC1mLGUpLGU+Pj04LWYsdC09OC1mLGY9OCksOD09PWYmJihmPTAsYysrKX1sZXQgYT1uKCk7dmFyIHM9MioqbCxlPTIqKmwrMTtsZXQgaT0yKipsKzIsZD1sKzEsdT0yKipkO2xldCBoPW5ldyBVaW50OEFycmF5KDI1NiksYz0wLGY9MCxnPSIiLHY9IiI7cihzKTtmb3IobGV0IGU9MCx0PW8ubGVuZ3RoO2U8dDtlKyspdj1TdHJpbmcuZnJvbUNoYXJDb2RlKG9bZV0pLGEuaGFzKGcrdik/Zys9djoocihhLmdldChnKSksNDA5Mz09PWk/KHIocyksYT1uKCksaT0yKipsKzIsZD1sKzEsdT0yKipkKTooaT09PXUmJihkKyssdT0yKipkKSxhLnNldChnK3YsaSsrKSksZz12LHY9IiIpO2cmJnIoYS5nZXQoZykpLHIoZSk7bGV0IHQ9bnVsbDtyZXR1cm4gdD1mP2guc2xpY2UoMCxjKzEpOmguc2xpY2UoMCxjKX19O2NsYXNzIHR7Y29uc3RydWN0b3IoKXt0aGlzLm1heENvbG9yPTI1NCx0aGlzLmNvbG9yQ291bnQ9MCx0aGlzLnRyZWU9bmV3IHMsdGhpcy50cmVlLmxldmVsPS0xLHRoaXMubGV2ZWxOb2Rlcz1uZXcgQXJyYXkoOCkuZmlsbCgwKS5tYXAoKCk9PltdKX1hZGRDb2xvcihvLGwsbil7bGV0IHI9dGhpcy50cmVlO2ZvcihsZXQgdD03OzA8PXQ7dC0tKXt2YXIgYT0oQyhvLHQsMSk8PDIpKyhDKGwsdCwxKTw8MSkrQyhuLHQsMSk7bGV0IGU9ci5ub2Rlc1thXTtpZihlfHwoci5ub2Rlc1thXT1uZXcgcywoZT1yLm5vZGVzW2FdKS5sZXZlbD03LXQsKGUucGFyZW50PXIpLm5vZGVzQ291bnQrKyxlLmlkeEluTGV2ZWxOb2Rlcz10aGlzLmxldmVsTm9kZXNbZS5sZXZlbF0ubGVuZ3RoLHRoaXMubGV2ZWxOb2Rlc1tlLmxldmVsXS5wdXNoKGUpLDc9PT1lLmxldmVsJiZ0aGlzLmNvbG9yQ291bnQrKyksZS5jb3VudCsrLGUucmVkU3VtKz1vLGUuZ3JlZW5TdW0rPWwsZS5ibHVlU3VtKz1uLGUuaXNMZWFmKWJyZWFrOzc9PT1lLmxldmVsJiYoZS5pc0xlYWY9ITApLHI9ZX10aGlzLmNvbG9yQ291bnQ+dGhpcy5tYXhDb2xvciYmdGhpcy5yZWR1Y2VDb2xvcigpfWdldENvbG9yKHQsbyxsKXtsZXQgbj10aGlzLnRyZWU7Y29uc3Qgcj1bMCwwLDAsMV07Zm9yKGxldCBlPTc7MDw9ZTtlLS0pe3ZhciBhPShDKHQsZSwxKTw8MikrKEMobyxlLDEpPDwxKStDKGwsZSwxKSxhPW4ubm9kZXNbYV07aWYoIWEpYnJlYWs7aWYoYS5pc0xlYWYpe3JbMF09YS5yZWRTdW0vYS5jb3VudD4+MCxyWzFdPWEuZ3JlZW5TdW0vYS5jb3VudD4+MCxyWzJdPWEuYmx1ZVN1bS9hLmNvdW50Pj4wO2JyZWFrfW49YX1yZXR1cm4gcn1yZWR1Y2VDb2xvcigpe2xldCBvPW51bGwsbD1OdW1iZXIuTUFYX1NBRkVfSU5URUdFUjtmb3IobGV0IGU9NjswPD1lO2UtLSl7dmFyIG4scj10aGlzLmxldmVsTm9kZXNbZV07Zm9yKGxldCBlPTAsdD1yLmxlbmd0aDtlPHQ7ZSsrKSFyW2VdfHwhKG49cltlXSkuaXNMZWFmJiYxPG4ubm9kZXNDb3VudCYmbi5jb3VudDxsJiYobz1uLGw9bi5jb3VudCk7aWYobylicmVha31vJiZ0aGlzLmRlbGV0ZVN1Yk5vZGVzKG8pfWRlbGV0ZVN1Yk5vZGVzKG8pe2ZvcihsZXQgZT0wLHQ9by5ub2Rlcy5sZW5ndGg7ZTx0O2UrKyl7dmFyIGw9by5ub2Rlc1tlXTtsJiYobC5pc0xlYWZ8fHRoaXMuZGVsZXRlU3ViTm9kZXMobCksdGhpcy5sZXZlbE5vZGVzW2wubGV2ZWxdW2wuaWR4SW5MZXZlbE5vZGVzXT1udWxsKX10aGlzLmNvbG9yQ291bnQtPW8ubm9kZXNDb3VudC0xLG8ubm9kZXM9W10sby5ub2Rlc0NvdW50PTAsby5pc0xlYWY9ITB9fWNsYXNzIHN7Y29uc3RydWN0b3IoKXt0aGlzLmlzTGVhZj0hMSx0aGlzLmxldmVsPTAsdGhpcy5jb3VudD0wLHRoaXMucmVkU3VtPTAsdGhpcy5ncmVlblN1bT0wLHRoaXMuYmx1ZVN1bT0wLHRoaXMucGFyZW50PW51bGwsdGhpcy5ub2Rlcz1bXSx0aGlzLm5vZGVzQ291bnQ9MCx0aGlzLmlkeEluTGV2ZWxOb2Rlcz0wfX1jb25zdCBsPXtnaWZMendEZWNvZGU6ZS5kZWNvZGUsZ2lmTHp3RW5jb2RlOmUuZW5jb2RlLGNvbG9yVHJhbnNmb3JtOmZ1bmN0aW9uKGwpe2NvbnN0IG49e2NvbG9yVGFibGU6W10sZnJhbWVzOltdfTtpZihsLmxlbmd0aCl7Y29uc3QgaD1uZXcgTWFwLGM9bmV3IE1hcCxmPW5ldyB0O2xldCBvPW51bGw7dmFyIHIsYSxzLGk7Zm9yKGxldCBlPTAsdD1sLmxlbmd0aDtlPHQ7ZSsrKXt2YXIgZD1sW2VdLmltYWdlRGF0YTtmb3IobGV0IGU9MCx0PWQud2lkdGgqZC5oZWlnaHQqNDtlPHQ7ZSs9NCkwPT09ZC5kYXRhW2UrM10/bnVsbD09PW8mJihvPVtkLmRhdGFbZV0sZC5kYXRhW2UrMV0sZC5kYXRhW2UrMl0sMF0pOihbYSxzPTBdPVtkLmRhdGEsZV0saT12b2lkIDAsYS5sZW5ndGg+PXMrNCYmMDxhW3MrM10mJmFbcyszXTwyNTUmJihpPWFbcyszXS8yNTUsYVtzXT1hW3NdKmk+PjAsYVtzKzFdPWFbcysxXSppPj4wLGFbcysyXT1hW3MrMl0qaT4+MCxhW3MrM109MjU1KSksZi5hZGRDb2xvcihkLmRhdGFbZV0sZC5kYXRhW2UrMV0sZC5kYXRhW2UrMl0pfWNvbnNvbGUubG9nKGYpLHI9Zi5jb2xvckNvdW50O2ZvcihsZXQgZT0wLHQ9bC5sZW5ndGg7ZTx0O2UrKyl7Y29uc3QgZz1sW2VdLmltYWdlRGF0YSx2PW5ldyBVaW50OEFycmF5KGcud2lkdGgqZy5oZWlnaHQpO2ZvcihsZXQgbz0wLGw9MCxlPWcud2lkdGgqZy5oZWlnaHQqNDtvPGU7bys9NCxsKyspaWYoMCE9PWcuZGF0YVtvKzNdKXtsZXQgZT1udWxsLHQ9IiI7dmFyIHU9W2cuZGF0YVtvXSxnLmRhdGFbbysxXSxnLmRhdGFbbysyXV0uam9pbigpO2guaGFzKHUpP2U9aC5nZXQodSk6KGU9Zi5nZXRDb2xvcihnLmRhdGFbb10sZy5kYXRhW28rMV0sZy5kYXRhW28rMl0pLGguc2V0KHUsZSksdD1lLmpvaW4oKSxjLmhhcyh0KXx8KGMuc2V0KHQsbi5jb2xvclRhYmxlLmxlbmd0aCksbi5jb2xvclRhYmxlLnB1c2goW2VbMF0sZVsxXSxlWzJdXSkpKSxnLmRhdGFbb109ZVswXSxnLmRhdGFbbysxXT1lWzFdLGcuZGF0YVtvKzJdPWVbMl0sdltsXT1jLmdldCh0KX1lbHNlIHZbbF09cjtuLmZyYW1lcy5wdXNoKHtpbWFnZURhdGE6ZyxpbmRpY2VzOnZ9KX1jb25zb2xlLmxvZyhuKSxvPW98fG4uY29sb3JUYWJsZVtuLmNvbG9yVGFibGUubGVuZ3RoLTFdLG4uY29sb3JUYWJsZS5wdXNoKFtvWzBdLG9bMV0sb1sxXV0pfXJldHVybiBufX07b25tZXNzYWdlPWU9Pnt2YXJ7YWN0aW9uOmUscGFyYW06dCxfc2lnbjpvfT1lLmRhdGE7ImZ1bmN0aW9uIj09dHlwZW9mIGxbZV0/KHQ9e2FjdGlvbjplLHJlc3VsdDpsW2VdKC4uLm51bGwhPXQ/dDpbXSksX3NpZ246b30scG9zdE1lc3NhZ2UodCkpOmNvbnNvbGUubG9nKGBhY3Rpb24gJHtlfSBub3QgZm91bmRgKX19KCk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPXdvcmtlclV0aWxzLmpzLm1hcAoK");var s,l,h,d,m,b,y=n?t(z,s,l):(h=z,d=s,m=l,function(t){return b=b||a(h,d,m),new Worker(b,t)}),n=Math.max(window.navigator.hardwareConcurrency-1,1);const x=new Map,v=[],w=new Array(n).fill(null).map((t,e)=>({index:e,worker:new y,idle:!0}));function M(){let t=null;var e;v.length&&(t=w.find(t=>t.idle))&&(t.idle=!1,e=v.shift(),x.set(e._sign,e.p),t.worker.postMessage(Object.assign(Object.assign({},e.job),{_sign:e._sign}),e.job.transferable||[]))}w.map(e=>{e.worker.addEventListener("message",t=>{t.data&&t.data._sign?(x.get(t.data._sign).resolve(t.data.result),x.delete(t.data._sign),e.idle=!0,M()):(console.error("worker 返回数据错误"),x.get(t.data._sign).reject("worker 返回数据错误"))})});function Z(h,d){return o(this,void 0,void 0,function*(){if(!(h instanceof ArrayBuffer)){if(c(d))return d(g.gifDataTypeError,"onDataError");throw new Error(g.gifDataTypeError)}var t=new Uint8Array(h);const e={ptr:0},i={header:{type:"",isGif:!1,version:"",width:0,height:0,gctFlag:!1,cr:0,sortFlag:!1,gctSize:0,gctStartByte:0,gctEndByte:0,bgIndex:0,pixelAspect:0,gctList:[]},frames:[]};for(var a=window.performance.now();e.ptr<t.length;){if(0===e.ptr){var r=function(e,t){const i={type:"",isGif:!1,version:""};for(let t=0;t<3;t++)i.type+=String.fromCharCode(e[t]);if(i.isGif=i.type==="GIF",i.isGif){for(let t=3;t<6;t++)i.version+=String.fromCharCode(e[t]);t.ptr=5}return i}(t,e);if(!r.isGif)return d(g.notGif,"onDataError");Object.assign(i.header,r)}else if(6===e.ptr){var r=function(t,e){const i={width:0,height:0,gctFlag:!1,cr:0,sortFlag:!1,gctSize:0,gctStartByte:0,gctEndByte:0,bgIndex:0,pixelAspect:0};i.width=t[6]+(t[7]<<8),i.height=t[8]+(t[9]<<8),i.gctFlag=Boolean(t[10]>>7),i.cr=t[10]>>4&7,i.sortFlag=Boolean(8&t[10]),i.gctSize=Math.pow(2,1+(7&t[10])),i.gctFlag&&(i.gctStartByte=13,i.gctEndByte=13+3*i.gctSize-1);return i.bgIndex=t[11],i.pixelAspect=t[12],e.ptr=12,i}(t,e),n=(Object.assign(i.header,r),r.gctFlag?(++e.ptr,function(e,t,i){const a=3*t,r=13+a,n=[];for(let t=13;t<r;t+=3)n.push([e[t],e[t+1],e[t+2]]);return i.ptr=r-1,n}(t,r.gctSize,e)):[]);i.header.gctList=n}else if(e.ptr+1<t.length&&33===t[e.ptr]&&255===t[e.ptr+1]&&!i.appExt){n=function(e,t){const i={appName:"",verification:"",blockIdx:1,repetitionTimes:0,startByte:0,endByte:0};i.startByte=t.ptr;let a=i.startByte;var r=e[a+=2];a++;for(let t=0;t<r-3;t++)i.appName+=String.fromCharCode(e[a+t]);a+=r-3;for(let t=0;t<3;t++)i.verification+=String.fromCharCode(e[a+t]);a+=3;var n=e[a];return i.endByte=a+n,i.blockIdx=e[a+1],i.repetitionTimes=e[a+2]+(e[a+3]<<8),t.ptr=i.endByte,i}(t,e);i.appExt=n}else if(e.ptr+1<t.length&&33===t[e.ptr]&&249===t[e.ptr+1])i.frames.push(L(t,e));else if(44===t[e.ptr]){const l=L(t,e);var s=i.frames[i.frames.length-1];s.endByte?i.frames.push(l):(l.startByte=s.startByte,l.disposalMethod=s.disposalMethod,l.userInputFlag=s.userInputFlag,l.transColorFlag=s.transColorFlag,l.delay=s.delay,l.transColorIdx=s.transColorIdx,i.frames[i.frames.length-1]=l)}else if(e.ptr+1<t.length&&33===t[e.ptr]&&1===t[e.ptr+1])i.frames.push(L(t,e));else if(59===t[e.ptr])break;e.ptr++}console.log("parse: ",window.performance.now()-a),a=window.performance.now();const o=yield Promise.all(i.frames.map(t=>G({action:"gifLzwDecode",param:[t.codeSize,t.imageData],transferable:[t.imageData.buffer]})));return console.log("duration: ",window.performance.now()-a),o.map((t,e)=>{i.frames[e].imageData=t}),i})}var G=a=>new Promise((t,e)=>{var i=Date.now()*Math.random();v.push({_sign:i,job:a,p:{resolve:t,reject:e}}),M()});function L(i,t){const a={startByte:t.ptr,endByte:0,width:0,height:0,left:0,top:0,disposalMethod:0,userInputFlag:!1,transColorFlag:!1,delay:0,transColorIdx:0,lctFlag:!1,interlace:!1,sortFlag:!1,lctSize:0,lctStartByte:0,lctEndByte:0,lctList:[],codeSize:0,imageData:new Uint8Array,imageStartByte:0,imageEndByte:0};if(33===i[t.ptr]&&249===i[t.ptr+1]&&(t.ptr+=2,r=i[t.ptr],r=t.ptr+r+1,t.ptr++,a.disposalMethod=(28&i[t.ptr])>>2,a.userInputFlag=Boolean((2&i[t.ptr])>>1),a.transColorFlag=Boolean(1&i[t.ptr]),a.delay=10*(i[++t.ptr]+(i[++t.ptr]<<8)),a.transColorIdx=i[++t.ptr],(0!==i[++t.ptr]||t.ptr>r)&&(t.ptr=r)),44===i[t.ptr]){if(a.left=i[++t.ptr]+(i[++t.ptr]<<8),a.top=i[++t.ptr]+(i[++t.ptr]<<8),a.width=i[++t.ptr]+(i[++t.ptr]<<8),a.height=i[++t.ptr]+(i[++t.ptr]<<8),a.lctFlag=Boolean(128&i[++t.ptr]),a.interlace=Boolean(64&i[t.ptr]),a.sortFlag=Boolean(32&i[t.ptr]),a.lctSize=Math.pow(2,1+(7&i[t.ptr])),a.lctFlag){a.lctStartByte=t.ptr+1,a.lctEndByte=t.ptr+3*a.lctSize;for(let t=a.lctStartByte;t<a.lctEndByte;t+=3)a.lctList.push([i[t],i[t+1],i[t+2]]);t.ptr=a.lctEndByte}t.ptr++,a.imageStartByte=t.ptr;var r=i[t.ptr++];const o=[];let e=0;for(;0!==i[t.ptr]&&void 0!==i[t.ptr];){var n=i[t.ptr++],s=i.slice(t.ptr,t.ptr+n);e+=s.length,o.push(s),t.ptr+=n}a.imageEndByte=t.ptr,a.endByte=t.ptr;const l=new Uint8Array(e);for(let t=o.length-1;0<=t;t--)l.set(o[t],e-=o[t].length);a.codeSize=r,a.imageData=l}return a}function S(i){var t=performance.now();let a=0,r=t;a=window.requestAnimationFrame(function t(e){1e3/60<=e-r&&(r=e-(e-r)%(1e3/60),i.map(t=>{t(e)})),a=window.requestAnimationFrame(t)})}function C(t,i){const a=t.frames[i];if(a.canvasImageData instanceof ImageData)return a.canvasImageData;var r=function t(i,e){if(e<=0)return;const a=i.frames[e-1];if(0===a.disposalMethod)return;if(2===a.disposalMethod){const r=i.header.gctFlag?[...i.header.gctList[i.header.bgIndex],255]:[...p];let t=a.canvasImageData;t=t||C(i,e-1);const n=new ImageData(t.width,t.height);n.data.set(t.data);for(let e=a.top;e<a.top+a.height;e++)for(let t=a.left;t<a.left+a.width;t++){const s=e*i.header.width+t<<2;n.data[s]=r[0],n.data[1+s]=r[1],n.data[2+s]=r[2],n.data[3+s]=r[3]}return n}if([1].includes(a.disposalMethod))return a.canvasImageData||C(i,e-1);if(3===a.disposalMethod)return t(i,e-1);return}(t,i),n=a.lctFlag?a.lctList:t.header.gctList,s=t.header.gctFlag?[...t.header.gctList[t.header.bgIndex],255]:[...p],o=t.header.width,i=t.header.height,l=D(a);const h=new Uint8ClampedArray(o*i*4);for(let t=0,e=o*i;t<e;t++){var d=t%o,c=t/o>>0,g=t<<2;d>=a.left&&d<a.left+a.width&&c>=a.top&&c<a.top+a.height?(d=d-a.left+(c-a.top)*a.width,a.transColorFlag&&l[d]===a.transColorIdx?r&&(h[g]=r.data[g],h[1+g]=r.data[1+g],h[2+g]=r.data[2+g],h[3+g]=r.data[3+g]):(c=n[l[d]],h[g]=c[0],h[1+g]=c[1],h[2+g]=c[2],h[3+g]=255)):r?(h[g]=r.data[g],h[1+g]=r.data[1+g],h[2+g]=r.data[2+g],h[3+g]=r.data[3+g]):(h[g]=s[0],h[1+g]=s[1],h[2+g]=s[2],h[3+g]=s[3])}t=new ImageData(h,o,i);return a.canvasImageData=t}function I(t,e){const i=t.frames[e];if(i.rawImageData instanceof ImageData)return i.rawImageData;var a=i.lctFlag?i.lctList:t.header.gctList,r=D(i);const n=new Uint8ClampedArray(i.width*i.height*4);for(let t=0;t<i.imageData.length;t++){var s,o=t<<2;i.transColorFlag&&r[t]===i.transColorIdx?(n[o]=0,n[1+o]=0,n[2+o]=0,n[3+o]=0):(s=a[r[t]],n[o]=s[0],n[1+o]=s[1],n[2+o]=s[2],n[3+o]=255)}const l=new ImageData(i.width,i.height);return l.data.set(n),i.rawImageData=l}function D(i){const a=new Uint8Array(i.imageData.length);let r=0;function e(e){for(let t=0;t<i.width;t++)a[r]=i.imageData[e*i.width+t],r++}if(i.interlace){let t=0;for(;t<i.height;)e(t),t+=8;for(t=4;t<i.height;)e(t),t+=8;for(t=2;t<i.height;)e(t),t+=4;for(t=1;t<i.height;)e(t),t+=2}else a.set(i.imageData);return a}class P extends class{constructor(t){this.keys=[],this.watch={},this.amzGif=t,this.cache={},this.init()}init(){this.dirtyChecking()}dirtyChecking(){const e=[];let i;Object.keys(this.watch).map(t=>{i=this.getValue(t),this.cache[t]!==i&&e.push({key:t,oldValue:this.cache[t],newValue:i})}),e.map(t=>o(this,void 0,void 0,function*(){c(this.watch[t.key])&&(yield this.watch[t.key](t.newValue,t.oldValue))}))}getValue(t){var e=t.split(".").filter(t=>t);let i=this.amzGif;for(let t=0;t<e.length&&void 0!==(i=null===i||void 0===i?void 0:i[e[t]]);t++);return i}}{constructor(t){super(t),this.playDiv=null,this.playImg=null,this.loadingDiv=null,this.loadingImg=null,this.loadingImgRoate=0,this.handlePlay=this.handlePlay.bind(this),this.dirtyChecking=this.dirtyChecking.bind(this),this.init(),this.setWatch()}init(){const t=this.amzGif._canvas.parentElement;if(t){var e=t.getBoundingClientRect();const i=this.genMask(e.width,e.height),a=(i.style.zIndex="1",i.style.display="none",i.style.cursor="pointer",i.addEventListener("click",this.handlePlay.bind(this)),this.playDiv=i,document.createElement("img")),r=(a.src="data:image/svg+xml;base64,PHN2ZyB0PSIxNjYyNzg5NjY0NjUyIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjIzNjciIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIj48cGF0aCBkPSJNMTI4IDEzOC42NjY2NjdjMC00Ny4yMzIgMzMuMzIyNjY3LTY2LjY2NjY2NyA3NC4xNzYtNDMuNTYyNjY3bDY2My4xNDY2NjcgMzc0Ljk1NDY2N2M0MC45NiAyMy4xNjggNDAuODUzMzMzIDYwLjggMCA4My44ODI2NjZMMjAyLjE3NiA5MjguODk2QzE2MS4yMTYgOTUyLjA2NCAxMjggOTMyLjU2NTMzMyAxMjggODg1LjMzMzMzM3YtNzQ2LjY2NjY2NnoiIGZpbGw9IiMzRDNEM0QiIHAtaWQ9IjIzNjgiPjwvcGF0aD48L3N2Zz4=",a.style.width="60px",a.style.height="60px",a.style.opacity="0.6",this.playImg=a,i.appendChild(a),t.appendChild(i),this.genMask(e.width,e.height)),n=((this.loadingDiv=r).style.zIndex="2",r.style.display="none",document.createElement("img"));(this.loadingImg=n).src="data:image/svg+xml;base64,PHN2ZyB0PSIxNjYyNzg5NzI0Njc4IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM0NDEiIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIj48cGF0aCBkPSJNNTEyLjUxMSAyMS40ODNjLTI3MS4xNjMgMC00OTEuMDI4IDIxOS44Ni00OTEuMDI4IDQ5MS4wMjggMCAyNzEuMTczIDIxOS44NTYgNDkxLjAzIDQ5MS4wMjggNDkxLjAzIDI2LjU1NCAwIDQ4LjA4LTIxLjUyNyA0OC4wOC00OC4wOCAwLTI2LjU1NC0yMS41MjYtNDguMDgtNDguMDgtNDguMDgtMjE4LjA2NSAwLTM5NC44NjktMTc2LjgwNC0zOTQuODY5LTM5NC44NyAwLTIxOC4wNiAxNzYuODEzLTM5NC44NjkgMzk0Ljg3LTM5NC44NjkgMjE4LjA2NSAwIDM5NC44NjkgMTc2LjgwNCAzOTQuODY5IDM5NC44NyAwIDI2LjU1MyAyMS41MjYgNDguMDggNDguMDggNDguMDggMjYuNTUzIDAgNDguMDgtMjEuNTI3IDQ4LjA4LTQ4LjA4IDAtMjcxLjE3My0yMTkuODU3LTQ5MS4wMy00OTEuMDMtNDkxLjAzeiIgcC1pZD0iMzQ0MiI+PC9wYXRoPjwvc3ZnPg==",n.style.width="60px",n.style.height="60px",n.style.opacity="0.6",r.appendChild(n),t.appendChild(r),this.amzGif._rAFCallbackQueue.push(this.dirtyChecking.bind(this))}else this.amzGif._errCall(g.skinError,"onError")}genMask(t,e){const i=document.createElement("div");return i.style.backgroundColor="rgba(0, 0, 0, 0.3)",i.style.width=t+"px",i.style.height=e+"px",i.style.position="absolute",i.style.left="0",i.style.top="0",i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center",i}setWatch(){this.watch.isPlaying=t=>{this.playDiv&&(this.playDiv.style.display=t||this.amzGif.isLoading?"none":"flex")},this.watch.isLoading=t=>{this.loadingDiv&&(this.loadingDiv.style.display=t?"flex":"none",t&&this.loadingImg&&(this.loadingImg.style.transform=`rotate(${this.loadingImgRoate+=1}deg)`))}}handlePlay(){this.amzGif.isPlaying||this.amzGif.play()}}function _(n){return o(this,void 0,void 0,function*(){const t={buf:N(new Uint8Array(0)),ptr:0};var e,i;if(i=t,e=n.header,i.buf[0]=e.type.charCodeAt(0),i.buf[1]=e.type.charCodeAt(1),i.buf[2]=e.type.charCodeAt(2),i.buf[3]=e.version.charCodeAt(0),i.buf[4]=e.version.charCodeAt(1),i.buf[5]=e.version.charCodeAt(2),i.ptr=6,e=t,i=n.header,e.buf[6]=255&i.width,e.buf[7]=i.width>>8,e.buf[8]=255&i.height,e.buf[9]=i.height>>8,e.buf[10]=u(e.buf[10],7,1,Number(i.gctFlag)),e.buf[10]=u(e.buf[10],4,3,i.cr-1),e.buf[10]=u(e.buf[10],3,1,Number(i.sortFlag)),e.buf[10]=u(e.buf[10],0,3,f(i.gctSize)-1),e.buf[11]=i.bgIndex,e.buf[12]=i.pixelAspect,e.ptr=13,n.header.gctFlag&&W(t,n.header.gctList),n.appExt){var a=t,r=n.appExt;a.ptr+18>=a.buf.length&&(a.buf=N(a.buf)),a.buf[a.ptr++]=33,a.buf[a.ptr++]=255,a.buf[a.ptr++]=r.appName.length+r.verification.length;for(let t=0,e=r.appName.length;t<e;t++)a.buf[a.ptr++]=r.appName.charCodeAt(t);for(let t=0,e=r.verification.length;t<e;t++)a.buf[a.ptr++]=r.verification.charCodeAt(t);a.buf[a.ptr++]=3,a.buf[a.ptr++]=r.blockIdx,a.buf[a.ptr++]=255&r.repetitionTimes,a.buf[a.ptr++]=r.repetitionTimes>>8,a.buf[a.ptr++]=0}return yield function(d,c,i){return o(this,void 0,void 0,function*(){const a=[];var t=window.performance.now(),r=yield Promise.all(c.map((t,e)=>(a[e]=t.lctFlag?f(t.lctSize):f(i),G({action:"gifLzwEncode",param:[a[e],t.imageData]}))));console.log("encode frames buffer: ",window.performance.now()-t);for(let t=0,e=c.length;t<e;t++){var n=c[t],s=(o=s=void 0,d),o=n,o=(s.ptr+8>=s.buf.length&&(s.buf=N(s.buf)),s.buf[s.ptr++]=33,s.buf[s.ptr++]=249,s.buf[s.ptr++]=4,s.buf[s.ptr]=u(s.buf[s.ptr],2,3,o.disposalMethod),s.buf[s.ptr]=u(s.buf[s.ptr],1,1,Number(o.userInputFlag)),s.buf[s.ptr]=u(s.buf[s.ptr],0,1,Number(o.transColorFlag)),s.ptr++,s.buf[s.ptr++]=o.delay/10&255,s.buf[s.ptr++]=o.delay/10>>8,s.buf[s.ptr++]=o.transColorIdx,s.buf[s.ptr++]=0,s=o=void 0,d),s=n;o.ptr+10>=o.buf.length&&(o.buf=N(o.buf)),o.buf[o.ptr++]=44,o.buf[o.ptr++]=255&s.left,o.buf[o.ptr++]=s.left>>8,o.buf[o.ptr++]=255&s.top,o.buf[o.ptr++]=s.top>>8,o.buf[o.ptr++]=255&s.width,o.buf[o.ptr++]=s.width>>8,o.buf[o.ptr++]=255&s.height,o.buf[o.ptr++]=s.height>>8,o.buf[o.ptr]=u(o.buf[o.ptr],7,1,Number(s.lctFlag)),o.buf[o.ptr]=u(o.buf[o.ptr],6,1,Number(s.interlace)),o.buf[o.ptr]=u(o.buf[o.ptr],2,1,Number(s.sortFlag)),o.buf[o.ptr]=u(o.buf[o.ptr],0,3,f(s.lctSize)-1),o.ptr++,n.lctFlag&&W(d,n.lctList);for(var l=r[t],h=l.length+Math.ceil(l.length/255);d.ptr+1+h>=d.buf.length;)d.buf=N(d.buf);d.buf[d.ptr++]=a[t];let i=d.ptr;for(let t=0,e=l.length;t<e;t++)i===d.ptr&&d.ptr++,d.buf[d.ptr]=l[t],d.ptr-i!=255&&t+1!==e||(d.buf[i]=d.ptr-i,i=d.ptr+1),d.ptr++;d.buf[d.ptr++]=0}})}(t,n.frames,n.header.gctSize),t.ptr>=t.buf.length&&(t.buf=N(t.buf)),t.buf[t.ptr]=59,t.ptr++,t.buf.slice(0,t.ptr)})}function W(i,a){for(let t=0,e=a.length;t<e;t++)i.ptr+3>=i.buf.length&&(i.buf=N(i.buf)),i.buf[i.ptr++]=a[t][0],i.buf[i.ptr++]=a[t][1],i.buf[i.ptr++]=a[t][2]}function N(t){var e=1048576;if(e=e||256,t instanceof Uint8Array){const i=new Uint8Array(t.length+e);return i.set(t),i}}function F(t){return"number"==typeof t?Math.max(0,Math.min(t,255)):0}function j(s){return o(this,void 0,void 0,function*(){const a={header:{type:"GIF",isGif:!0,version:"89a",width:0,height:0,gctFlag:!0,cr:7,sortFlag:!1,gctSize:0,gctStartByte:0,gctEndByte:0,bgIndex:0,pixelAspect:1,gctList:[]},appExt:{appName:"NETSCAPE",blockIdx:1,startByte:0,endByte:0,verification:"2.0",repetitionTimes:0},frames:[]};let i;const r=[[]],n=(s.frames.map((t,e)=>{t.setLocalColorTable?r.push([{frameIdx:e,frameData:t}]):r[0].push({frameIdx:e,frameData:t})}),yield Promise.all(r.map(t=>(console.log(t),G({action:"colorTransform",param:[t.map(t=>t.frameData)]})))));console.log("quantizedFrames: ",n),r.map((t,i)=>{t.map((t,e)=>{0===i?a.header.gctList=n[i].colorTable:a.frames[t.frameIdx].lctList=n[i].colorTable,a.frames[t.frameIdx]={},a.frames[t.frameIdx].imageData=n[i].frames[e].indices})});[...t]=[...s.frames.map(t=>t.imageData)];var t={x:Math.max(...t.map(t=>t.width)),y:Math.max(...t.map(t=>t.height))};a.header.width=t.x,a.header.height=t.y;let e=[0,0,0];return s.backgroundColor&&(e=function(t){const e=new Array(4).fill(0),i=(e[3]=1,t.replace(/ /g,""));if(i)if(i.startsWith("#")){t=parseInt(i.substring(1),16);if(4===i.length){if(!(0<=t&&t<=4095))return e;e[0]=(3840&t)>>4|(3840&t)>>8,e[1]=240&t|(240&t)>>4,e[2]=15&t|(15&t)<<4}else if(7===i.length){if(!(0<=t&&t<=16777215))return e;e[0]=(16711680&t)>>16,e[1]=(65280&t)>>8,e[2]=255&t}}else{var t=i.indexOf("("),a=i.indexOf(")");if(-1!==t&&a+1===i.length){var r,n=i.substring(0,t),s=i.substring(t+1,a).split(",");switch(n){case"rgba":4===s.length&&(r=F(255*parseFloat(s.pop())),e[3]=r);case"rgb":3===s.length&&(e[0]=F(parseInt(s[0])),e[1]=F(parseInt(s[1])),e[2]=F(parseInt(s[2])))}}}return e}(s.backgroundColor)),i=a.header.gctList.length-1,a.header.bgIndex=a.header.gctList.length,a.header.gctList.push([e[0],e[1],e[2]]),a.header.gctList=T(a.header.gctList),a.header.gctSize=a.header.gctList.length,a.appExt&&(a.appExt.repetitionTimes=s.repetition),a.frames.forEach((t,e)=>{e=s.frames[e];t.startByte=0,t.endByte=0,t.width=e.imageData.width,t.height=e.imageData.height,t.left=(a.header.width-t.width)/2>>0,t.top=(a.header.height-t.height)/2>>0,t.disposalMethod=e.disposalMethod||1,t.userInputFlag=!1,t.transColorFlag=!0,t.delay=e.delay||10,t.lctList=t.lctList||[],t.lctFlag=!!t.lctList.length,t.interlace=!1,t.sortFlag=!1,t.transColorIdx=t.lctFlag?t.lctList.length-1:i,t.lctList=t.lctFlag?T(t.lctList):[],t.lctSize=t.lctList.length,t.codeSize=f(t.lctSize),t.imageStartByte=0,t.imageEndByte=0}),_(a)})}function T(e){let t=f(e.length);t<4&&(t=4);var i=Math.pow(2,t);for(let t=0;t<i;t++)e[t]||(e[t]=[0,0,0]);return e}var z={decode(t,e){return o(this,void 0,void 0,function*(){return Z(t,t=>e(t))})},encode(t){return o(this,void 0,void 0,function*(){return _(t)})},build(t){return o(this,void 0,void 0,function*(){return j(t)})},getFrameImageData:I,getFramesImageData(i){return i.frames.map((t,e)=>I(i,e))},getCompositeFrameImageData:C,getCompositeFramesImageData(i){return i.frames.map((t,e)=>C(i,e))}};class Y{constructor(t){this.speedList=i,this._imgEl=null,this._canvas=null,this._ctx=null,this._offscreenCanvas=null,this._offscreenCtx=null,this._gifBuffer=null,this.gifData=null,this._currFrame=-1,this._nextUpdateTime=performance.now(),this._rAFCallbackQueue=[],this.isLoading=!1,this.isPlaying=!1,this.isRendering=!1,this._config=Object.assign(Object.assign({},e),t),i.includes(this._config.speed)||(this._config.speed=1),this._update=this._update.bind(this),this._renderFrame=this._renderFrame.bind(this),this._togglePlay=this._togglePlay.bind(this),this._init()}_init(){if(this._config.el){if(this._config.el instanceof HTMLImageElement&&(this._imgEl=this._config.el),"string"==typeof this._config.el){var t=document.querySelector(this._config.el);if(!t)return void this._errCall(g.noImg+this._config.el,"onError");if(!(t instanceof HTMLImageElement))return void this._errCall(g.notImg(this._config.el),"onError");this._imgEl=t}setTimeout(()=>{var t;this._initCanvas(),this._initContainer(),(t=this)._config.interactive&&"basic"===t._config.skin&&new P(t),!0===this._config.auto&&this.play(),this._rAFCallbackQueue.push(this._update),S(this._rAFCallbackQueue)})}else this._errCall(g.noConfigEl,"onError")}_initCanvas(){var t;const e=this._imgEl;var i=e.getBoundingClientRect();console.log(i),this._config.width="number"==typeof this._config.width?this._config.width:null!=(t=null==i?void 0:i.width)?t:0,this._config.height="number"==typeof this._config.height?this._config.height:null!=(t=null==i?void 0:i.height)?t:0,this._canvas=document.createElement("canvas"),this._canvas.style.cursor="pointer",this._canvas.addEventListener("click",this._togglePlay),this._canvas.width=this._config.width,this._canvas.height=this._config.height,this._canvas.style.width=this._config.width+"px",this._canvas.style.height=this._config.height+"px",this._ctx=this._canvas.getContext("2d"),this._ctx.globalCompositeOperation="copy",null!=(t=this._ctx)&&t.drawImage(e,0,0,null!=(t=null==i?void 0:i.width)?t:this._config.width,null!=(t=null==i?void 0:i.height)?t:this._config.height,0,0,null!=(t=this._config.width)?t:null==i?void 0:i.width,null!=(t=this._config.height)?t:null==i?void 0:i.height)}_initContainer(){var t,e=this._imgEl;const i=document.createElement("div");e.id&&(i.id=e.id),i.style.width=this._config.width+"px",i.style.height=this._config.height+"px",i.style.position="relative",i.style.display="inline-block",this._canvas&&(i.appendChild(this._canvas),null!=(t=e.parentElement)&&t.replaceChild(i,e))}play(){var e;return o(this,void 0,void 0,function*(){if(null===this._gifBuffer){if(!this._config.src&&"function"!=typeof this._config.httpRequest)return this._errCall(g.noGifUrl,"onError");yield this._getGif().catch(t=>this._errCall(t.message,"onLoadError"))}if(null!==this._gifBuffer){if(null===this.gifData){var t=yield Z(this._gifBuffer,this._errCall);if(!t||!t.header.isGif)return;this.gifData=t,this._offscreenCanvas=document.createElement("canvas"),this._offscreenCanvas.width=null==(e=this.gifData)?void 0:e.header.width,this._offscreenCanvas.height=null==(e=this.gifData)?void 0:e.header.height,this._offscreenCtx=this._offscreenCanvas.getContext("2d")}if(c(this._config.onBeforePlay))if(!(yield this._config.onBeforePlay()))return;this.isPlaying=!0,this._nextUpdateTime=Math.max(this._nextUpdateTime,performance.now()),this._checkEnd()&&(this._currFrame=-1),c(this._config.onPlay)&&this._config.onPlay()}})}pause(){return o(this,void 0,void 0,function*(){if(c(this._config.onBeforePause)&&!(yield this._config.onBeforePause()))return;this.isPlaying=!1,c(this._config.onPause)&&this._config.onPause()})}nextFrame(){return this.gifData&&this._ctx&&this._offscreenCtx?this.isRendering?g.isRendering:(this._currFrame=(this._currFrame+1)%this.gifData.frames.length,this._renderFrame(),void(this._nextUpdateTime=performance.now()+this.gifData.frames[this._currFrame].delay/this._config.speed)):this._errCall(g.notReady,"onError")}prevFrame(){return this.gifData&&this._ctx&&this._offscreenCtx?this.isRendering?g.isRendering:(this._currFrame--,this._currFrame<0&&(this._currFrame=this.gifData.frames.length-1),this._renderFrame(),void(this._nextUpdateTime=performance.now()+this.gifData.frames[this._currFrame].delay/this._config.speed)):this._errCall(g.notReady,"onError")}jump(t){return this.gifData?"number"!=typeof t?this._errCall(g.wrongParam,"onError"):this.isRendering?g.isRendering:((t<0||t>this.gifData.frames.length-1)&&(t=0),this._currFrame=t,void this._renderFrame()):this._errCall(g.notReady,"onError")}setSpeed(t){return!!this.speedList.includes(t)&&(this._config.speed=t,!0)}_togglePlay(){!1!==this._config.interactive&&(this.isPlaying?this.pause():this.play())}_update(t){if(this.isPlaying&&!this.isRendering&&this.gifData&&this._ctx&&this._offscreenCtx&&!document.hidden&&!(this._nextUpdateTime>t))if(this._currFrame++,this._checkEnd())this.isPlaying=!1,c(this._config.onEnd)&&this._config.onEnd();else for(this._renderFrame();this._nextUpdateTime<=t;)this._nextUpdateTime+=Math.max(this.gifData.frames[this._currFrame].delay/this._config.speed,1),this._nextUpdateTime<=t&&(this._currFrame++,this._checkEnd()&&(this.isPlaying=!1,c(this._config.onEnd)&&this._config.onEnd(),this._currFrame=this.gifData.frames.length-1,this._renderFrame()))}_renderFrame(){var t=this.gifData,i=this._ctx,a=this._offscreenCtx;this.isRendering=!0;{var r=this._currFrame,n=t=>c(this._config.filter)?this._config.filter(t):t;let e=C(t,r);if(c(n)){let t=new ImageData(e.width,e.height);t.data.set(e.data),t=n(t),e=t}a.putImageData(e,0,0),i.drawImage(a.canvas,0,0,e.width,e.height,0,0,i.canvas.width,i.canvas.height),e}this.isRendering=!1}_checkEnd(){return this._currFrame>this.gifData.frames.length-1&&(!1===this._config.loop||(this._currFrame=0,!1))}_getGif(){return o(this,void 0,void 0,function*(){if(this.isLoading=!0,c(this._config.httpRequest))try{const t=yield this._config.httpRequest(this._config.src);this._gifBuffer=yield t.arrayBuffer()}catch(t){this._errCall(null==t?void 0:t.message,"onLoadError")}else try{const e=yield fetch(this._config.src);this._gifBuffer=yield e.arrayBuffer(),c(this._config.onLoad)&&this._config.onLoad()}catch(t){this._errCall(null==t?void 0:t.message,"onLoadError")}this.isLoading=!1})}_errCall(t,e){var i;if(c(this._config[e]))null!=(e=(i=this._config)[e])&&e.call(i,t);else{if(!c(this._config.onError))throw new Error(t);null!=(i=(e=this._config).onError)&&i.call(e,t)}}}return Y.filter={grayscale:function(i){for(let t=0,e=i.data.length;t<e;t+=4){var a=.3*i.data[t]+.59*i.data[t+1]+.11*i.data[t+2]>>0;i.data[t]=i.data[t+1]=i.data[t+2]=a}return i},blackAndWhite:function(i){for(let t=0,e=i.data.length;t<e;t+=4){var a=(i.data[t]+i.data[t+1]+i.data[t+2])/3;i.data[t]=i.data[t+1]=i.data[t+2]=100<=a?255:0}return i},reverse:function(i){for(let t=0,e=i.data.length;t<e;t+=4)i.data[t]=255-i.data[t],i.data[t+1]=255-i.data[t+1],i.data[t+2]=255-i.data[t+2];return i},decolorizing:function(i){for(let t=0,e=i.data.length;t<e;t+=4){var a=(Math.min(i.data[t],i.data[t+1],i.data[t+2])+Math.max(i.data[t],i.data[t+1],i.data[t+2]))/2>>0;i.data[t]=i.data[t+1]=i.data[t+2]=a}return i},monochromeRed:function(i){for(let t=0,e=i.data.length;t<e;t+=4)i.data[t+1]=i.data[t+2]=0;return i},monochromeGreen:function(i){for(let t=0,e=i.data.length;t<e;t+=4)i.data[t]=i.data[t+2]=0;return i},monochromeBlue:function(i){for(let t=0,e=i.data.length;t<e;t+=4)i.data[t]=i.data[t+1]=0;return i},nostalgic:function(i){for(let t=0,e=i.data.length;t<e;t+=4){var a=i.data[t],r=i.data[t+1],n=i.data[t+2],s=.349*a+.686*r+.168*n,o=.272*a+.534*r+.131*n;i.data[t]=Math.min(255,Math.max(0,.393*a+.769*r+.189*n)),i.data[t+1]=Math.min(255,Math.max(0,s)),i.data[t+2]=Math.min(255,Math.max(0,o))}return i},cast:function(i){for(let t=0,e=i.data.length;t<e;t+=4){var a=i.data[t],r=i.data[t+1],n=i.data[t+2],s=128*r/(a+n+1),o=128*n/(r+a+1);i.data[t]=Math.min(255,Math.max(0,128*a/(r+n+1))),i.data[t+1]=Math.min(255,Math.max(0,s)),i.data[t+2]=Math.min(255,Math.max(0,o))}return i},frozen:function(i){for(let t=0,e=i.data.length;t<e;t+=4){var a=i.data[t],r=i.data[t+1],n=i.data[t+2],s=3*(r-a-n)/2,o=3*(n-r-a)/2;i.data[t]=Math.min(255,Math.max(0,3*(a-r-n)/2)),i.data[t+1]=Math.min(255,Math.max(0,s)),i.data[t+2]=Math.min(255,Math.max(0,o))}return i},comic:function(i){for(let t=0,e=i.data.length;t<e;t+=4){var a=i.data[t],r=i.data[t+1],n=i.data[t+2];i.data[t]=Math.abs(r-n+r+a)*a/256,i.data[t+1]=Math.abs(n-r+n+a)*a/256,i.data[t+2]=Math.abs(n-r+n+a)*r/256}return i},brown:function(i){for(let t=0,e=i.data.length;t<e;t+=4){var a=i.data[t],r=i.data[t+1],n=i.data[t+2],s=.349*a+.686*r+.168*n,o=.272*a+.534*r+.131*n;i.data[t]=Math.min(255,Math.max(0,.393*a+.769*r+.189*n)),i.data[t+1]=Math.min(255,Math.max(0,s)),i.data[t+2]=Math.min(255,Math.max(0,o))}return i},boxBlur:function(i,a=5){const r=new ImageData(i.width,i.height);var n,s;r.data.set(i.data),a=a%2?a:a+1;let o=new Uint8ClampedArray(a*a),l=0,h=0;for(let e=0,t=i.data.length;e<t;e+=4){n=e/4%i.width,s=e/4/i.width>>0;for(let t=0;t<3;t++){o=function(i,a,r,n,s,o,l){let h=!1,d=!1;var c,g,f=[s/2>>0,o/2>>0];let u=0;for(let e=0;e<s;e++)for(let t=0;t<o;t++)h=!1,d=!1,0<(c=f[0]-e)?a<c&&(h=!0):a-c>=i.width&&(h=!0),g=f[1]-t,t<f[1]?r<g&&(d=!0):r-g>=i.height&&(d=!0),h&&d?u=0<c&&0<g?0:c<0&&g<0?4*(i.width*i.height-1):0<c?i.width*(i.height-1)*4:4*(i.width-1):h?u=c<0?(r-g)*i.width*4:4*((r-g)*i.width-1):d&&(u=g<0?4*(a-c):4*((i.height-1)*i.width+a-c)),u=4*((r-g)*i.width+(a-c)),n[e+s*t]=i.data[u+l];return n}(i,n,s,o,a,a,t);for(let t=l=0,e=o.length;t<e;t++)l+=o[t];(h=l/o.length>>0)<0?h=0:255<h&&(h=255),r.data[e+t]=h}}return r}},Y.gifKit=z,Y});
